---
title: "Sticks, leaves, buckets, and bowls: Distributional patterns of children’s at-home object handling in two subsistence societies"
bibliography: CogSci2022-giannino.bib
csl: apa6.csl
document-params: "10pt, letterpaper"

author-information: >
  \author{Kennedy Casey \\
          University of Chicago \\
          \texttt{\small{kbcasey@uchicago.edu}}
  \And \textbf{Mary Elliott} \\
               University of Texas at Dallas \\
               \texttt{\small{maryle18@gmail.com}}
  \And \textbf{Anapaula Silva Mandujano} \\
               University of Chicago \\
               \texttt{\small{anapaula@uchicago.edu}}   
  \And \textbf{Kimberly Shorter} \\
               University of Chicago \\
               \texttt{\small{klshorter@uchicago.edu}}
  \AND \textbf{Elizabeth Mickiewicz} \\
               University of Chicago \\
               \texttt{\small{lizmick9@uchicago.edu}}         
  \And \textbf{Mara Duquette} \\
               University of Chicago \\
               \texttt{\small{duquettemara@uchicago.edu}}
  \And \textbf{Elika Bergelson} \\
               Duke University \\
               \texttt{\small{elika.bergelson@duke.edu}}
  \And \textbf{Marisa Casillas} \\
               University of Chicago \\
               \texttt{\small{mcasillas@uchicago.edu}}}

abstract: >
  Object-centric interactions provide rich learning moments for young children, including opportunities to discover word meanings. Children’s own object handling, in particular, forms a key source of input – one that varies across cultures and across development. Using daylong photo streams from child-worn cameras (>16k images), we analyze the frequency and targets of child object handling across the first four years in two small-scale subsistence farming communities on opposite sides of the globe (Papuan and Mayan). Overall, we see a general consistency in the broad composition of handled objects across cultures and age. However, a few notable cross-cultural differences and age-related changes indicate the likely influence of many factors on the rate and distribution of child object handling, including object availability, child carrying practices, daily activities, and maturational constraints.

keywords:
    
output: cogsci2016::cogsci_paper
#final-submission: \cogscifinalcopy
---

```{r global_options, include = FALSE}
knitr::opts_chunk$set(fig.width = 3, fig.height = 3, fig.crop  =  FALSE, 
                      fig.pos  =  "tb", fig.path = 'figs/',
                      echo = FALSE, warning = FALSE, cache = FALSE, 
                      message = FALSE, sanitize = TRUE)
```

```{r, libraries}
library(tidyverse)
library(lubridate)
library(broom)
library(broom.mixed)
library(lme4)
library(lmerTest)
library(gghalves)
library(cowplot)
library(ggpubr)
library(ggeffects)
library(xtable)
library(kableExtra)
```

```{r, data-prep}
run.from.raw = FALSE
if (run.from.raw) {
  # this R script creates the "all-data.csv"
  # set run.from.raw equal to TRUE if you want to regenerate it
  source("../data-prep.R")
} 

# read in data
raw.data <- read_csv("../data/all-data.csv")

# read in C&E data for all codeable hours per ptcp
codeable.hrs.pp <- read_csv(
  "../data/metadata/all-hours-with-codeable-photos-per-ptcp.csv")

# pre-set colors and category labels
sites <- c("Rossel", "Tseltal")

site.colors <- c("Rossel" = "#3C5388", 
                 "Tseltal" = "#02A087")

categories <- c("Food", "Synthetic", "Toy", "Natural",
                "Clothing", "Mealtime Tool", "Immovable", 
                "Work Tool")

category.labels <- c("Food", "Synthetic", "Toy", "Natural",
                "Clothing", "Tool-M", "Immovable", 
                "Tool-W")

# rm excluded photos + set other variable info
data <- raw.data %>%
  filter(is.na(exclusion)) %>%
  mutate(hour = hour(timestamp),
         category = factor(category, levels = categories))

# set rm.study.related to TRUE if you want to check results w/o these
study.related <- c("camera", "vest", "camera cover")
# define operator that selects all but the things in a list
`%notin%` <- Negate(`%in%`)

rm.study.related = FALSE
if (rm.study.related) {
  data <- data %>%
      filter(object %notin% study.related)
}
```

# Introduction

The objects that we regularly pick up and handle---a coffee cup, a laptop, a baby bottle---offer a window into the physical, social, and cultural contexts that shape our understanding of the world. In this paper, we take a glimpse into everyday life at its beginnings by exploring children's at-home object handling from early infancy until age four. We contextualize our study with respect to the effects of object-centric interaction on word learning, though we note that different analyses of these same data could shed new light on other types of social learning, in addition to motor development [see @herzberg2021exuberant, on the latter point].
<!--mc: for future writing, as far as i can tell, this general area is called material culture studies and is an interdisciplinary field with archeology, anthropology, and sociology. i need to do more reading!!-->

## Object handling and word learning

For young learners, objects---along with their associated activities and surrounding language---form a critical source of input for word learning. Hands (and what they are handling) can be reliable indicators of what someone is attending to and talking about during object play <!--mc: NB: we look at a lot more than play and i'm not sure how well this idea generalizes, especially across cultures! but that's an issue for another day. or rather another fieldtrip. someday :*-) --> and can thus help learners map word forms onto their meanings in and across real-time interaction [e.g., @yu2013joint; @yurovsky2013statistical]. The labels of present, attended-to objects are reflected in the babble of children who have acquired stable consonants [@laing2020babble]. Further, caregivers' tendency to use nouns referring to objects in the here-and-now positively predicts their children's early word comprehension [@bergelson2017nature; see also @slone2019self]. <!--kc: i messed around with the wording a little bit but feel free to switch back! wondering, though, if the order of these last two sentences should be flipped. OR possibly reorder so it goes sentence 1432: objects/surrounding lang are a critical source of word learning input. adults label objects which predicts word comprehension. kids also label objects. there can still be uncertainty surrounding what's actually being labeled, but HANDS hands can be reliable indicators. would need to rework wording of the next para a little bit if we go this route-->

How frequently do children engage in object-centric interactions? First, hands---others' and their own---are in good supply in young children's view of the world, especially after early infancy [@fausey2016faces; @jayaraman2017faces; @long2020detecting]. Infants' own object handling is relatively frequent: Herzberg and colleagues [-@herzberg2021exuberant] find that US infants handle objects ${\sim}60\%$ of the time during at-home play, Yu and colleagues [-@yu2013joint] find ${\sim}70\%$ when including joint handling with adults in US in-lab object play, and Casillas and Elliott [-@casillasURdaylong] find ${\sim}15$ and 17% object handling in daylong photo streams in a Papuan and a Mayan community, respectively. Concurrent with these events, children will sometimes encounter linguistic information relating to the focused-on object (e.g., its label and associated concepts). However, this critical additional ingredient for word learning may only occur during a small subset of total object handling time. We do not yet know how often objects in the here and now are typically talked about over the course of children's whole waking days at home, but we do know that such talk fluctuates across high and low activity periods [@bergelson2019day]. We also know that children's object handling varies enormously across the first few years due to cross-cultural differences in available objects and caregiving practices as well as maturational constraints.

## Object handling across cultures

The array of objects available to children varies in type and prevalence across cultures. Objects spread via globalization (e.g., plastic bags) and objects with a basic functional role that has arisen similarly across many groups (e.g., spoon-like tools for eating) are likely to appear widely, while other objects remain specific to people and places (e.g., the gourd and bombilla for drinking mate in much of South America, stemming from Indigenous Guaraní and Tupí tradition). Early access to objects is also shaped by culture-specific practices for carrying children, keeping them safe and warm, and scaffolding the development of locally-valued capacities [e.g., word learning in many US families, walking in Kenyan Kipsigis families: @super1976environmental; see @adolph2010motor, for an overview]. Take, for example, middle-class US family homes, which have been noted for their large quantities of possessions ("clutter"), much of which is designed specifically for children [e.g., toys and books: @arnold2012life]. We might infer, based on these assemblages of home objects, that much of what children do and talk about at home is centered around what particularly interests them. Recent work by Herzberg and colleagues [-@herzberg2021exuberant] underscores this point with data from infants (13--23 months old) who spent nearly 70% of their time in object play with toys or a mix of toys and non-toys, with ${\sim}100\%$ of infants playing with children's books and stuffed animals, and a total of 32 toy types appearing in ${\ge}25\%$ of infants' play. Non-toy play was also common but still appeared to predominantly include infant-specific objects (e.g., sippy cups, baby spoons, high chairs, pacifiers). We would expect many of these items to be rare in other parts of the world, with much greater overlap between objects for infants and objects for adults [e.g., @karasik2018not].

## Object handling across age

In early infancy, children have little ability to hold things or to control their posture, primarily experiencing objects through what others bring near to them. Faces, rather than objects, may make up a much greater proportion of their social and visual input early on [@fausey2016faces; @jayaraman2017faces; but see also @long2020detecting]. However, later gains in manual dexterity and gross motor skill (e.g., sitting, crawling, walking) increasingly widen children's ability to seek, reach, and grab a diversity of objects in their environments<!--mc: :P ---including those meant to be out of reach, EDNA-->. Increasing motor development not only gives children greater control over what objects they handle, but also _how_ they elicit social information relating to objects and for how long [@adolph2010motor; @herzberg2021exuberant; @gaskins2000childrens; @kretch2014crawling; @sanchez2018detecting].

## The current study

Using daylong photo streams from child-worn cameras, we analyze object handling by children under age four in two rural, small-scale subsistence farming communities from opposite sides of the globe: Rossel Island ("Rossel"; Milne Bay Province, Papua New Guinea) and Tenejapa ("Tseltal"; Chiapas, Mexico). While these communities are comparable in many ways (e.g., rural, swidden horticulturalist, housed in multi-generation family complexes), prior work has established substantial differences in the organization of young children's daily lives, child carrying practices, and each community's level of market integration (i.e., greater availability of synthetic materials in Tenejapa), leading us to expect differences in the objects that children handle across the day and early lifespan [@brownIPchildrearing; @casillasURdaylong; @casillas2020early; @casillas2021early]. We first establish how often children handle objects from different categories (e.g., food vs. tools), both by the total amount of handling and by number of unique objects per hour in each category across sites. We explore the top individual objects in each site along with the overlap that exists between sites. Finally, we investigate how the rate and characteristics of object handling change with age.

Our findings reveal relative consistency in the broad composition of objects handled by children, both between sites and across age, with a few important exceptions: a greater diversity of synthetic objects handled by Tseltal children (e.g., relating to greater market integration), more time spent with immovable objects for Rossel children (e.g., relating to socializing time on/near household verandas), and a greater diversity of held objects and greater number of transitions between handled objects across age. We discuss open questions and potential implications of these findings for early word learning.

# Method
```{r, exclusions}
# get total number of images before exclusion
total.coded <- raw.data %>%
  select(sub_num, image) %>%
  distinct() %>%
  nrow()

# get total number of images after exclusion
total.included <- data %>%
  select(sub_num, image) %>%
  distinct() %>%
  nrow()

# get exclusion counts and percentages
exclusions <- raw.data %>%
  filter(!is.na(exclusion)) %>%
  select(sub_num, image, exclusion) %>%
  distinct() %>%
  group_by(exclusion) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(percent = round(count/total.coded * 100, 2)) %>%
  pivot_wider(names_from = "exclusion", values_from = c("count", "percent"))
```

## Corpus
Daylong photo streams consisted of images captured approximately every 15 (Rossel) to 30 (Tseltal) seconds over the course of 8 (Rossel) to 9 (Tseltal) waking hours at home. Children wore a recording vest equipped with a camera (Narrative Clip 1) and miniature fisheye lens (Photojojo Super Fisheye) that provided a 180$\text{\textdegree}$ view of the environment. For younger infants who were not yet walking, the camera was instead worn by the primary caregiver. Previously, 83 daylong photo streams (113668 photos) had been comprehensively manually annotated for the presence or absence of child object handling [@casillasURdaylong]. Here, we further annotate and analyze the subset of `r total.coded` with object handling in the present study.

```{r, demo}
# create tibbles with basic descriptive stats of kid demographics and # images
demo.bysite <- data %>%
  group_by(site, sub_num, age) %>%
  summarize(n.images = length(unique(image))) %>%
  group_by(site) %>%
  summarize(n.kids = length(unique(sub_num)), 
            m.images = mean(n.images),
            m.age = mean(age))

demo <- data %>%
  group_by(sub_num, age) %>%
  summarize(n.images = n()) %>%
  ungroup() %>%
  summarize(min.images = min(n.images), 
            max.images = max(n.images), 
            mean.images = mean(n.images),
            median.images = median(n.images),
            min.age = min(age), 
            max.age = max(age),
            n.kids = length(unique(sub_num)))
```

We included one daylong photo stream from each of `r demo$n.kids` children (Rossel: `r subset(demo.bysite, site == "Rossel")$n.kids`, Tseltal: `r subset(demo.bysite, site == "Tseltal")$n.kids`), ranging in age from `r demo$min.age` to `r demo$max.age` months (_M_~_Rossel_~ = `r round(subset(demo.bysite, site == "Rossel")$m.age, 1)`, _M_~_Tseltal_~ = `r round(subset(demo.bysite, site == "Tseltal")$m.age, 1)`). The amount of object handling and thus the number of photos annotated varied across children, ranging from `r demo$min.images` to `r demo$max.images` (_M_~_Rossel_~ = `r round(subset(demo.bysite, site == "Rossel")$m.images, 1)`, _M_~_Tseltal_~ = `r round(subset(demo.bysite, site == "Tseltal")$m.images, 1)`). <!--kc: consider dropping kids with very few images or reporting median which is more representative-->

```{r examples-fig, fig.env = "figure", fig.pos = "h", fig.align = "center", fig.width = 2.9, fig.height = 2.4, fig.cap = "Example images with object and category labels."}

examples <- png::readPNG("../figs/example-objects.png")
grid::grid.raster(examples)
```

## Manual annotation
Photos were annotated with IMCO, an open-source Python program adapted for efficient coding of photo streams [@casey2022imco]. Annotators provided labels for the handled object(s) in each photo (e.g., "twig") and selected among predefined categories to characterize each type of object (e.g., "Natural"). Categories included food, mealtime tools ("Tool-M"), toys, clothing, tools for working or cleaning ("Tool-W"), immovable objects (e.g., furniture and housing structures), natural objects, and miscellaneous synthetic objects (see Figure 1 for example images and Table 1 for example objects from each category). In the reported findings, "object" refers to any exemplar of a type of object (e.g., any twig) rather than a particular instance of an object (e.g., this specific twig), and "object category" refers to the predefined categories we used for each object type (e.g., "Natural", "Toys", "Immovable").

## Data preparation and reliability
Images were excluded if they were too dark, bright, blurry, or covered for annotators to identify handled objects (`r exclusions$count_Exclude` images, `r exclusions$percent_Exclude`% of the data set), if annotators were otherwise unsure about what objects were being handled (`r exclusions$count_Unsure`, or `r exclusions$percent_Unsure`%), if there was no handled object (`r exclusions$count_None`, or `r exclusions$percent_None`%), or if the researcher was still present when the image was captured (`r exclusions$count_Experimenter`, or `r exclusions$percent_Experimenter`%). To avoid unnecessary data loss, all excluded photos were checked by at least one other annotator and re-included for analysis if objects were identifiable. <!--kc: something's not adding up here, either in the exclusion counts or the original total coded count. will double check and fix--> In total, `r total.included` images were deemed usable by annotators (`r data %>% filter(site == "Rossel") %>% select(sub_num, image) %>% distinct() %>% nrow()` for Rossel, `r data %>% filter(site == "Tseltal") %>% select(sub_num, image) %>% distinct() %>% nrow()` for Tseltal).

XX% of photo streams were double coded. Reliability annotations were equally spread across sites and ages and included a total of XXXX images. At the category level, annotators agreed on XX.X% of decisions (Rossel: XX.X%, Tseltal: XX.X%). At the object label level, annotators agreed on XX.X% of decisions (Rossel: XX.X%, Tseltal: XX.X%).

```{r top-objects, results = "asis"}
# compute the objects that most often appear 1+ times across children w/i sites
# use this to find the top 3 items per category per site
top.objects.bykids <- data %>%
  filter(object %notin% study.related) %>%
  select(site, category, object, sub_num) %>%
  distinct() %>%
  group_by(site) %>%
  summarize(total = length(unique(sub_num)), 
            category = category, 
            object = object, 
            sub_num = sub_num) %>%
  group_by(site, category, object, total) %>%
  summarize(n.children = length(unique(sub_num))) %>%
  mutate(prop.children = n.children/total) %>%
  ungroup() %>%
  arrange(site, category, desc(prop.children)) %>%
  group_by(site, category) %>%
  mutate(rank = row_number()) %>%
  filter(rank %in% 1:3) %>%
  select(-n.children, -prop.children) %>%
  pivot_wider(names_from = "rank", values_from = "object") %>%
  mutate(objects = paste0(`1`, ", ", `2`, ", ", `3`), 
         objects = str_remove(objects, "-M|-W")) %>%
  select(category, objects, site) %>%
  group_by(category) %>%
  pivot_wider(names_from = "site", values_from = "objects")

# get list of all objects found in each site
ros.objects <- data %>% 
  filter(site == "Rossel" & object %notin% study.related) %>%
  pull(object) %>%
  unique()

tse.objects <- data %>% 
  filter(site == "Tseltal" & object %notin% study.related) %>%
  pull(object) %>%
  unique()

# compute the objects that appear in the most images across children w/i sites
# use this to find the top 3 items per category per site
tse.top.objects.bytime <- data %>%
  filter(site == "Tseltal" & object %notin% study.related) %>%
  group_by(site, sub_num) %>%
  mutate(n.images = length(unique(image)), 
         object = as_factor(object) %>% fct_expand(tse.objects)) %>%
  group_by(site, sub_num, n.images, category) %>%
  count(object, .drop = FALSE) %>%
  mutate(prop = n/n.images) %>%
  ungroup() %>%
  group_by(category, object) %>%
  summarize(m.prop = mean(prop)) %>%
  arrange(category, desc(m.prop)) %>%
  group_by(category) %>%
  mutate(rank = row_number()) %>%
  filter(rank %in% 1:3) %>%
  select(-m.prop) %>%
  pivot_wider(names_from = "rank", values_from = "object") %>%
  mutate(objects = paste0(`1`, ", ", `2`, ", ", `3`), 
         objects = str_remove(objects, "-M|-W"), 
         site = "Tseltal") %>%
  select(category, objects, site) %>%
  group_by(category) %>%
  pivot_wider(names_from = "site", values_from = "objects")

top.objects.bytime <- data %>%
  filter(site == "Rossel" & object %notin% study.related) %>%
  group_by(site, sub_num) %>%
  mutate(n.images = length(unique(image)), 
         object = as_factor(object) %>% fct_expand(ros.objects)) %>%
  group_by(site, sub_num, n.images, category) %>%
  count(object, .drop = FALSE) %>%
  mutate(prop = n/n.images) %>%
  ungroup() %>%
  group_by(category, object) %>%
  summarize(m.prop = mean(prop)) %>%
  arrange(category, desc(m.prop)) %>%
  group_by(category) %>%
  mutate(rank = row_number()) %>%
  filter(rank %in% 1:3) %>%
  select(-m.prop) %>%
  pivot_wider(names_from = "rank", values_from = "object") %>%
  mutate(objects = paste0(`1`, ", ", `2`, ", ", `3`), 
         objects = str_remove(objects, "-M|-W"), 
         site = "Rossel") %>%
  select(category, objects, site) %>%
  group_by(category) %>%
  pivot_wider(names_from = "site", values_from = "objects") %>%
  full_join(tse.top.objects.bytime, by = "category")
  
# compute number of objects in each category across sites
category.counts <- data %>%
  group_by(category, site) %>%
  summarize(n.objects = length(unique(object))) %>%
  pivot_wider(names_from = "site", values_from = "n.objects")

# combine and do some formatting to create table
tbl.input <- bind_cols(category.counts, top.objects.bykids, top.objects.bytime) %>%
  select(category...1, Rossel...2, Rossel...5, Rossel...8, Tseltal...3, Tseltal...6, Tseltal...9)

colnames(tbl.input) <- c("Object Category", "N", "Objects handled by the most children", "Objects handled for the most time", "N", "Objects handled by the most children", "Objects handled for the most time")

kable(tbl.input, format = "latex", 
      table.envir = "table*", 
      row.names = FALSE, 
      booktabs = TRUE,
      position = "!ht",
      caption = "Unique object counts and top objects for each category across sites.") %>%
  kable_styling(latex_options = "scale_down") %>%
  add_header_above(c(" " = 1, "Rossel" = 3, "Tseltal" = 3), align = "c", bold = TRUE) %>%
  row_spec(0, bold = TRUE)
```

# Results
## Overall frequency statistics
```{r, daily-object-stats, results = "hide"}
# compute descriptive stats of # unique objects held by individual kids

# ... overall
daily.objects <- data %>%
  group_by(sub_num) %>%
  summarize(n.objects = length(unique(object))) %>%
  ungroup() %>%
  summarize(mean = mean(n.objects), 
            median = median(n.objects), 
            sd = sd(n.objects), 
            min = min(n.objects),
            max = max(n.objects)) %>%
  mutate(across(mean:sd), round(., 2))

# ... by kid (incl. site info)
daily.objects.bysite <- data %>%
  group_by(sub_num, site) %>%
  summarize(n.objects = length(unique(object))) 

# t-test assumptions not met -> use wilcox
shapiro.test(subset(daily.objects.bysite,
                    daily.objects.bysite$site == "Rossel")$n.objects)
shapiro.test(subset(daily.objects.bysite,
                    daily.objects.bysite$site == "Tseltal")$n.objects)
var.test(n.objects ~ site, daily.objects.bysite)
comp.daily.objects <- tidy(wilcox.test(n.objects ~ site, daily.objects.bysite))

# rank objects according to how many kids handle them at least once
# w/in sites
ranked.objects.list <- list()
for (i in sites) {
  ranked.objects <- data %>%
    filter(site == i) %>%
    mutate(total.kids = length(unique(sub_num))) %>%
    group_by(object, total.kids) %>%
    summarize(n.kids = length(unique(sub_num)), 
              category = category) %>%
    distinct() %>%
    mutate(prop = n.kids/total.kids) %>%
    ungroup() %>%
    arrange(desc(prop)) %>%
    mutate(rank = row_number(), 
           site = i) 
  ranked.objects.list[[i]] <- ranked.objects
}
all.ranked.objects <- do.call(rbind, ranked.objects.list)

ros.objects <- all.ranked.objects %>%
  filter(site == "Rossel") %>%
  pull(object)

tse.objects <- all.ranked.objects %>%
  filter(site == "Tseltal") %>%
  pull(object)

# get top 25 objects for each site
ros.top.objects <- all.ranked.objects %>%
  filter(site == "Rossel" & rank <= 25) %>%
  pull(object)

tse.top.objects <- all.ranked.objects %>%
  filter(site == "Tseltal" & rank <= 25) %>%
  pull(object)

# compute percentage of kids that handled the camera at least once
camera <- all.ranked.objects %>%
  filter(object == "camera")

# compute percentage of images that include camera handling
camera.images <- data %>%
  group_by(sub_num, site) %>%
  mutate(n.images = length(unique(image)), 
         object = as_factor(object)) %>%
  group_by(sub_num, site, n.images) %>%
  count(object, .drop = FALSE) %>%
  filter(object == "camera") %>%
  summarize(prop = n/n.images) %>%
  distinct() %>%
  group_by(site) %>%
  summarize(min = min(prop), 
            max = max(prop), 
            mean = mean(prop), 
            median = median(prop))
  
# compute percentage of objects handled by only 1-2 kids in each site
uncommon.objects <- all.ranked.objects %>%
  group_by(site) %>%
  mutate(total = length(unique(object))) %>%
  filter(n.kids %in% 1:2) %>%
  group_by(site, total) %>%
  summarize(n = length(unique(object)), 
            prop = round(n/total*100, 2)) %>%
  distinct()
```

<!-- kc: need to add trailing zeros after rounding; mc2kc: try something like: printnum(YOURNUM, digits = 3). i tried using format() before but it didn't work and i can't remember why heh--> Children handled an average of `r daily.objects$mean` unique objects per day (median = `r daily.objects$median`, _SD_ = `r daily.objects$sd`, range = `r daily.objects$min`--`r daily.objects$max`), with no significant differences across sites (_M_~_Rossel_~ = `r round(mean(subset(daily.objects.bysite, daily.objects.bysite$site == "Rossel")$n.objects), 2)`, _M_~_Tseltal_~ = `r round(mean(subset(daily.objects.bysite, daily.objects.bysite$site == "Tseltal")$n.objects), 2)`, _W_ = `r comp.daily.objects$statistic`, _p_ = `r round(comp.daily.objects$p.value, 3)`). The distribution of handled objects was highly right-skewed within and across children. Each child's distribution was skewed such that a small group of objects was handled in a majority of their images but most objects were handled for only short periods of time (Figure 2). Across children, common objects followed a similar Zipfian distribution: some objects were handled by many children, but most objects were only handled by 1-2 children in each site (Rossel: `r subset(uncommon.objects, site == "Rossel")$prop`%, Tseltal: `r subset(uncommon.objects, site == "Tseltal")$prop`%).

```{r zipfian-objects-fig, fig.env = "figure", fig.pos = "h", fig.align = "center", fig.width = 2.9, fig.height = 1.5, fig.cap = "Zipfian distribution of objects handled by each child across sites. For each child, the top object was defined as the object appearing in the greatest number of images; thus, the identity of the top object does not match across all children."}

skew <- data %>%
  group_by(site, sub_num, object) %>%
  summarize(n.images = n()) %>%
  ungroup() %>%
  group_by(site, sub_num) %>%
  summarize(total = sum(n.images), 
            n.images = n.images,
            object = object) %>%
  distinct() %>%
  mutate(prop.images = n.images/total*100) %>%
  arrange(sub_num, desc(prop.images)) %>%
  mutate(order = row_number()) %>%
  ungroup()

ggplot(skew, aes(x = order, y = prop.images, 
             fill = site, color = site)) +
    facet_wrap(. ~ site) +
    geom_line(aes(group = sub_num), alpha = 0.25, size = 0.3) +
    geom_smooth(se = FALSE, method = "loess", size = 0.5, color = "black") +
    scale_color_manual(values = site.colors) +
    scale_fill_manual(values = site.colors) +
    scale_y_continuous(limits = c(0, 75), breaks = c(0, 25, 50, 75)) +
    labs(x = "Objects Ranked by Frequency", y = "% Images", 
         color = "Site", fill = "Site") +
    theme_test(base_size = 8) +
    theme(legend.position = "none")
```
Comparing across sites, `r round(length(intersect(ros.objects, tse.objects))/length(unique(raw.data$object)),4)*100`% of objects were handled by both Rossel and Tseltal children, and several shared objects were among the most frequently handled in both sites. In fact, among the top 25 most common objects, `r length(intersect(ros.top.objects, tse.top.objects))` were shared across sites (Figure 3). Of note, the study camera was the object that was handled by the most children in both sites [Rossel: `r round(subset(camera, site == "Rossel")$prop, 3)*100`%, Tseltal: `r round(subset(camera, site == "Tseltal")$prop, 3)*100`% of children, see @bergelson2019day, for a similar effect] but accounted for a relatively small percentage of each child's object handling time, on average (_M_~_Rossel_~ = `r round(subset(camera.images, site == "Rossel")$mean, 3)*100`%, _M_~_Tseltal_~ = `r round(subset(camera.images, site == "Tseltal")$mean, 3)*100`% of images). The camera and other study-related objects (i.e., vest and privacy cover for the camera), were retained in our analyses; however, inclusion of these items did not qualitatively change any of the reported results.

```{r, top-objects-fig, fig.env = "figure*", fig.pos = "!ht", fig.align = "center", fig.width = 5.5, fig.height = 2.5, set.cap.width = TRUE, num.cols.cap = 2, fig.cap = "Non-study-related objects handled at least once by the most children in each site. Filled bars represent objects that were among the top 25 for both sites."}

all.ranked.objects %>%
  # remove study-related and recalculate ranks
  filter(object %notin% study.related) %>%
  group_by(site) %>%
  arrange(desc(prop)) %>%
  mutate(rank = row_number(), 
         # add var to indicate whether object appears in both sites
         both = ifelse(object %in% ros.top.objects &
                         object %in% tse.top.objects, 1, 0), 
         category.label = factor(category,
                                 levels = categories, labels = category.labels),
         label = paste0(str_to_sentence(str_remove(
           object, "-M|-W|empty drink ")), " (", category.label, ")")) %>%
  filter(rank <= 25) %>%
  ggplot(aes(x = rank, y = prop*100, color = site, fill = site)) +
  facet_grid(. ~ site) +
  geom_bar(aes(alpha = as.factor(both)), stat = "identity") +
  geom_text(aes(y = prop*100/2, label = label),
            color = "black", srt = 90, size = 1.7) +
  scale_alpha_manual(values = c(0.2, 0.7)) +
  scale_color_manual(values = site.colors) +
  scale_fill_manual(values = site.colors) +
  labs(x = "Top 25 Objects", y = "% Children") +
  theme_test(base_size = 10) +
  theme(axis.text.x = element_blank(), axis.ticks.x = element_blank(), 
        legend.position = "none")
```

```{r, overall-category-stats}
# compute the prevalence of category-level objects within kids 
# (i.e., proportion of holding by category for each kid)
category.props <- data %>%
  group_by(sub_num, site) %>%
  mutate(n.images = length(unique(image))) %>%
  group_by(sub_num, site, n.images) %>%
  count(category, .drop = FALSE) %>%
  summarize(prop = n/n.images, 
            category = category) %>%
  distinct()
  
# test for differences between sites for each category
wilcox.outputs <- list()
for (i in categories) {
  ros.input <- category.props %>%
    filter(category == i & site == "Rossel")
  
  tse.input <- category.props %>%
    filter(category == i & site == "Tseltal")
  
  wilcox.output <- tidy(wilcox.test(ros.input$prop, tse.input$prop))
  
  wilcox.outputs[[i]] <- wilcox.output
}

comp.category.bysite <- do.call(rbind, wilcox.outputs) %>%
  rownames_to_column(var = "category") %>%
  mutate(p.adjusted = p.adjust(p.value, method = "holm"))

# compute descriptive statistics of category prevalence by site and category
category.means <- category.props %>%
  group_by(category, site) %>%
  summarize(mean = mean(prop), 
            sd = sd(prop), 
            n = n(), 
            se = sd/sqrt(n))

# compute # kids with synthetic or food as their top category
top.category.bychild <- category.props %>%
  group_by(sub_num) %>%
  filter(prop == max(prop) & category %in% c("Synthetic", "Food")) %>%
  nrow()

# compute mean # of categories per hour overall
# (first over subs, then over sample)
hourly.categories <- data %>%
  group_by(sub_num, hour) %>%
  summarize(n.categories = length(unique(category))) %>%
  ungroup() %>%
  summarize(mean = round(mean(n.categories), 2))

hourly.categories.incl.zeroes <- data %>%
  group_by(sub_num, hour) %>%
  summarize(n.categories = length(unique(category))) %>%
  ungroup() %>%
  full_join(codeable.hrs.pp) %>%
  replace_na(list(n.categories = 0)) %>%
  summarize(mean = round(mean(n.categories), 2))
```

## Effects of object category
We quantify the distribution of object categories at two timescales: across the whole waking day (i.e., overall % handling for different object categories across all images) and across individual hours (i.e., number of unique objects from different object categories per hour).

The overall frequency of object categories was similarly divided across sites (Figure 4A). Children primarily handled food items (_M_~_Rossel_~ = `r round(subset(category.means, site == "Rossel" & category == "Food")$mean, 4)*100`%, _M_~_Tseltal_~ = `r round(subset(category.means, site == "Tseltal" & category == "Food")$mean, 4)*100`% of handling) and miscellaneous synthetic objects (_M_~_Rossel_~ = `r round(subset(category.means, site == "Rossel" & category == "Synthetic")$mean, 4)*100`%, _M_~_Tseltal_~ = `r round(subset(category.means, site == "Tseltal" & category == "Synthetic")$mean, 4)*100`% of handling). For `r top.category.bychild` of `r length(unique(raw.data$sub_num))` children, their top category was either food or synthetic objects. Two-tailed Wilcoxon tests revealed no significant category-level differences between sites after correcting for multiple comparisons (all adjusted *p*s >0.05). The only categories trending toward difference were as follows: more handling of synthetic objects by Tseltal children (_M_~_Rossel_~ = `r round(subset(category.means, site == "Rossel" & category == "Synthetic")$mean, 4)*100`%, _M_~_Tseltal_~ = `r round(subset(category.means, site == "Tseltal" & category == "Synthetic")$mean, 4)*100`%), and more handling of mealtime tools (_M_~_Rossel_~ = `r round(subset(category.means, site == "Rossel" & category == "Mealtime Tool")$mean, 4)*100`%, _M_~_Tseltal_~ = `r round(subset(category.means, site == "Tseltal" & category == "Mealtime Tool")$mean, 4)*100`%) and immovable objects (_M_~_Rossel_~ = `r round(subset(category.means, site == "Rossel" & category == "Immovable")$mean, 4)*100`%, _M_~_Tseltal_~ = `r round(subset(category.means, site == "Tseltal" & category == "Immovable")$mean, 4)*100`%) by Rossel children.

```{r, hourly-object-stats}
# compute mean # objects per hour overall
# (first over subs, then over sample)
hourly.objects <- data %>%
  group_by(sub_num, hour) %>%
  summarize(n.objects = length(unique(object))) %>%
  ungroup() %>%
  summarize(mean = mean(n.objects), 
            median = median(n.objects), 
            sd = sd(n.objects), 
            min = min(n.objects),
            max = max(n.objects)) %>%
  mutate(across(mean:sd), round(., 2))

hourly.objects.incl.zeroes <- data %>%
  group_by(sub_num, hour) %>%
  summarize(n.objects = length(unique(object))) %>%
  ungroup() %>%
  full_join(codeable.hrs.pp) %>%
  replace_na(list(n.objects = 0)) %>%
  summarize(mean = mean(n.objects), 
            median = median(n.objects), 
            sd = sd(n.objects), 
            min = min(n.objects),
            max = max(n.objects)) %>%
  mutate(across(mean:sd), round(., 2))

# prep tibble for models w/ dummy coded category cols
model.data <- data %>%
  group_by(site, sub_num) %>%
  mutate(n.images = length(unique(image))) %>%
  group_by(site, sub_num, n.images, hour, category) %>%
  summarize(n.objects = length(unique(object))) %>%
  ungroup() %>%
  mutate(synthetic = ifelse(category == "Synthetic", 1, 0), 
         natural = ifelse(category == "Natural", 1, 0), 
         food = ifelse(category == "Food", 1, 0), 
         mealtime = ifelse(category == "Mealtime Tool", 1, 0),
         work = ifelse(category == "Work Tool", 1, 0), 
         clothing = ifelse(category == "Clothing", 1, 0),
         toy = ifelse(category == "Toy", 1, 0), 
         immovable = ifelse(category == "Immovable", 1, 0))

codeable.hrs.pp.bycategory <- expand_grid(
  codeable.hrs.pp, tibble(category = categories))

model.data.incl.zeroes <- data %>%
  group_by(site, sub_num) %>%
  mutate(n.images = length(unique(image))) %>%
  full_join(codeable.hrs.pp.bycategory) %>%
  replace_na(list(n.images = 0)) %>%
  group_by(site, sub_num, n.images, hour, category) %>%
  summarize(n.objects = length(unique(object))) %>%
  ungroup() %>%
  mutate(synthetic = ifelse(category == "Synthetic", 1, 0), 
         natural = ifelse(category == "Natural", 1, 0), 
         food = ifelse(category == "Food", 1, 0), 
         mealtime = ifelse(category == "Mealtime Tool", 1, 0),
         work = ifelse(category == "Work Tool", 1, 0), 
         clothing = ifelse(category == "Clothing", 1, 0),
         toy = ifelse(category == "Toy", 1, 0), 
         immovable = ifelse(category == "Immovable", 1, 0))

# run lmers
lmer.outputs <- list()
for (i in c(categories)) {
  
  lmer.output <- lmer(n.objects ~ site * eval(as.symbol(tolower(trimws(str_remove(i, "Tool"))))) +
                               (1|sub_num), model.data.incl.zeroes) %>%
  tidy() %>% 
  filter(effect == "fixed" & term != "(Intercept)")
  
  lmer.outputs[[i]] <- lmer.output
}

hourly.objects.model <- do.call(rbind, lmer.outputs) %>%
  rownames_to_column(var = "category") %>%
  mutate(p.adjusted = p.adjust(p.value, method = "holm"), 
         category = str_remove(category, ".1|.2|.3")) %>%
  group_by(category) %>%
  mutate(row = row_number(), 
         term = case_when(
           row == 1 ~ "site", 
           row == 2 ~ tolower(category),
           row == 3 ~ paste0("site:", tolower(category)))) %>%
  filter(p.adjusted < 0.10) %>%
  mutate(p = ifelse(p.adjusted < 0.001, 
                    paste0("< 0.001"), paste0("= ", round(p.adjusted, 3))))

# compute mean rate of objects/hr per category per kid
hourly.objects.bycategory <- model.data %>%
  group_by(site, sub_num, category) %>%
  summarize(n.objects.bysub = mean(n.objects)) %>%
  ungroup() %>%
  mutate(category = factor(category, levels = categories))
```

```{r overall-stats-fig, fig.env = "figure", fig.pos = "!h", fig.align = "center", fig.width = 3.4, fig.height = 4.4, fig.cap = "(A) Overall frequency of handling by object category. Points reflect percentages for individual children. (B) Count of unique objects handled per hour by object category. Points reflect means for individual children across all hours of recording. Asterisks indicate significant differences between sites after correcting for multiple comparisons."}

# create fig showing % of images with each category across sites
p1 <- ggplot() +
  # add bars with means
  geom_bar(data = category.means, 
           mapping  = aes(
             x = category, y = mean*100, color = site, fill = site),
           stat = "identity", position = "dodge", alpha = 0.7, width = 0.75) + 
  # add points for individual kids
  geom_point(data = category.props,
             mapping = aes(
               x = category, y = prop*100, color = site, fill = site),
             position = position_jitterdodge(
               dodge.width = 0.75, jitter.width = 0.1), 
             size = 0.5, alpha = 0.25) +
  # add error bars with SEs
  geom_errorbar(data = category.means,
                mapping = aes(x = category, ymin = (mean - se)*100, 
                              ymax = (mean + se)*100, group = site),
                position = position_dodge(width = 0.75), 
                width = 0.25, size = 0.5, color = "black") +
  scale_color_manual(values = site.colors) +
  scale_fill_manual(values = site.colors) +
  scale_x_discrete(labels = category.labels) + 
  labs(x = "Object Categories", y = "% Handling",
       color = "Site", fill = "Site", tag = "A") +
  theme_classic(base_size = 6) +
  theme(axis.title.x = element_blank())

# format so that only 1 legend appears at the bottom of the combined plot
p1a <- p1 + theme(legend.position = "none", legend.direction = "horizontal", 
                  plot.tag = element_text(face = "bold"))

legend <- get_legend(p1 + theme(legend.position = "bottom"))

# create fig showing unique objects per hr across categories and sites
p2 <- ggplot(hourly.objects.bycategory,
             aes(x = category, y = n.objects.bysub,
                 color = site, fill = site)) +
  geom_point(position = position_jitterdodge(
    dodge.width = 0.75, jitter.width = 0.1), size = 0.5, alpha = 0.5) +
  geom_boxplot(width = 0.75, outlier.shape = NA,
               alpha = 0.5, color = "black") +
  annotate(geom = "text", label = "*", x = "Immovable", y = 5, size = 6) +
  scale_color_manual(values = site.colors) + 
  scale_fill_manual(values = site.colors) +
  scale_x_discrete(labels = category.labels) + 
  labs(x = "Object Categories", y = "Unique Objects/Hour",
       color = "Site", fill = "Site", tag = "B") +
  theme_classic(base_size = 6) +
  theme(legend.position = "none", plot.tag = element_text(face = "bold"))

# combine plots and do some formatting
# (i.e., align axes and shrink space between panels)
fig1 <- align_plots(p1a, p2, align = "hv", axis = "l")
panels <- plot_grid(ggdraw(fig1[[1]]), NULL,
                    ggdraw(fig1[[2]]), nrow = 3, rel_heights = c(1, -0.07, 1))
plot_grid(panels, legend, ncol = 1, rel_heights = c(1, .1))
```

During any given hour, children handled `r format(round(hourly.objects.incl.zeroes$mean, 2), nsmall = 2)` objects from `r format(round(hourly.categories.incl.zeroes$mean, 2), nsmall = 2)` different categories, on average (median = `r format(round(hourly.objects.incl.zeroes$median, 2), nsmall = 2)` objects, _SD_ = `r format(round(hourly.objects.incl.zeroes$sd, 2), nsmall = 2)`, range = `r hourly.objects.incl.zeroes$min`--`r hourly.objects.incl.zeroes$max`). To test for differences across sites and categories, we ran individual linear mixed-effects models for each of the eight object categories, with category membership dummy coded (i.e., objects belonging to the target category for a given model = 1, objects belonging to other categories = 0). Each regression model included fixed effects of site, category, number of images, and a site-by-category interaction as well as random intercepts for individual children. After correcting for multiple comparisons, we found a significant main effect of the synthetic object category ($\beta$ = `r round(subset(hourly.objects.model, term == "synthetic")$estimate, 2)`, _SE_ = `r round(subset(hourly.objects.model, term == "synthetic")$std.error, 2)`, _t_ = `r round(subset(hourly.objects.model, term == "synthetic")$statistic, 2)`, _p_ `r subset(hourly.objects.model, term == "synthetic")$p`) and a marginal site-by-synthetic interaction ($\beta$ = `r round(subset(hourly.objects.model, term == "site:synthetic")$estimate, 2)`, _SE_ = `r round(subset(hourly.objects.model, term == "site:synthetic")$std.error, 2)`, _t_ = `r round(subset(hourly.objects.model, term == "site:synthetic")$statistic, 2)`, _p_ `r subset(hourly.objects.model, term == "site:synthetic")$p`) such that children handled more unique synthetic objects per hour than objects from other categories, and this effect was stronger for Tseltal children than for Rossel children. Additionally, we found negative main effects for the toy ($\beta$ = `r round(subset(hourly.objects.model, term == "toy")$estimate, 2)`, _SE_ = `r round(subset(hourly.objects.model, term == "toy")$std.error, 2)`, _t_ = `r round(subset(hourly.objects.model, term == "toy")$statistic, 2)`, _p_ `r subset(hourly.objects.model, term == "toy")$p`) and work tool ($\beta$ = `r round(subset(hourly.objects.model, term == "work tool")$estimate, 2)`, _SE_ = `r round(subset(hourly.objects.model, term == "work tool")$std.error, 2)`, _t_ = `r round(subset(hourly.objects.model, term == "work tool")$statistic, 2)`, _p_ `r subset(hourly.objects.model, term == "work tool")$p`) categories, indicating that children handled fewer unique objects from these categories per hour relative to other categories. Finally, a significant main effect of the immovable object category ($\beta$ = `r round(subset(hourly.objects.model, term == "immovable")$estimate, 2)`, _SE_ = `r round(subset(hourly.objects.model, term == "immovable")$std.error, 2)`, _t_ = `r round(subset(hourly.objects.model, term == "immovable")$statistic, 2)`, _p_ `r subset(hourly.objects.model, term == "immovable")$p`) and a significant site-by-immovable interaction ($\beta$ = `r round(subset(hourly.objects.model, term == "site:immovable")$estimate, 2)`, _SE_ = `r round(subset(hourly.objects.model, term == "site:immovable")$std.error, 2)`, _t_ = `r round(subset(hourly.objects.model, term == "site:immovable")$statistic, 2)`, _p_ `r subset(hourly.objects.model, term == "site:immovable")$p`) revealed that children handled more unique immovable objects per hour than objects from other categories, and this effect was stronger for Rossel children than for Tseltal children (Figure 4B).

## Effects of age
```{r age-effects-bycategory}
# compute prop of images in each category for each age
category.props.byage <- data %>%
  group_by(site, sub_num) %>%
  mutate(n.images = length(unique(image))) %>%
  group_by(sub_num, n.images, site, age) %>%
  count(category, .drop = FALSE) %>%
  summarize(prop = n/n.images, 
            category = category) %>%
  distinct()

# model age effects w/ indiv models for each category
age.bycategory.effects.list <- list()
age.bycategory.effects.toplot.list <- list()
for (i in categories) {
  model <- lm(prop ~ site * age + n.images,
                filter(category.props.byage, category == i))
  
  # check collinearity -> low
  # (making sure age and n.images aren't too strongly correlated)
  performance::check_collinearity(model)
  car::vif(model)
  
  effects <- tidy(model) %>%
    mutate(category = i, 
           p.adjusted = p.adjust(p.value, method = "holm")) %>%
    filter(term != "(Intercept)" & p.value < 0.10)
  
  # get predicted values from the model for plotting
  effects.toplot <- ggpredict(model,
                              terms = c("site", "age [all]"),
                              type = "fixed", back.transform = TRUE) %>%
  rename(age = group, site = x) %>%
  mutate(category = i)
  
  age.bycategory.effects.list[[i]] <- effects
  age.bycategory.effects.toplot.list[[i]] <- effects.toplot
}
age.bycategory.effects <- do.call(rbind, age.bycategory.effects.list)
age.bycategory.effects.toplot <- do.call(rbind, age.bycategory.effects.toplot.list) %>%
  mutate(category = factor(category, levels = categories), 
         age = as.numeric(as.character(age)))

# check correlation between age and number of images 
cor.data <- data %>%
  group_by(sub_num, age) %>%
  summarize(n.images = length(unique(image))) %>%
  mutate(age = as.numeric(as.character(age)))

cor <- cor.test(cor.data$age, cor.data$n.images) %>%
  tidy()
```
Prior work with the same data set indicated a significant increase in object handling across the first four years [@casillasURdaylong]. By adding information about _what_ objects children are handling, we can now explore finer-grained characteristics of age-related change in object handling. We investigate age-related changes in (a) the distribution of object categories, (b) the number of unique objects and categories handled per hour, and (c) transitions between objects and categories per hour.

_Do children handle different objects with age?_ We fit individual linear regressions predicting the proportion of handling time for each category as a function of age (in months), site, and their interaction. We included number of images as an additional fixed effect to account for the wide range in total available images for each child (range = `r demo$min.images`--`r demo$max.images`), leading to some proportions close to 0 or 1 that are based on only a handful of images^[As expected, number of handling images was correlated with age (_r_ = `r format(round(cor$estimate, 2), nsmall = 2)` [`r format(round(cor$conf.low, 2), nsmall = 2)`, `r format(round(cor$conf.high, 2), nsmall = 2)`], _p_ < 0.001), which we attribute to changes in motor development and permitted object access over the first four years [@casillasURdaylong]---the correlation is an artifactual outcome of development. Including both as fixed effects in a regression poses no technical issue in estimating $R^{2}$, but does limit the total variance attributed independently to either variable [@wurm2014residualizing]. Thus, for models of non-proportional measures, we rely solely on age to capture this variance.]. This analysis revealed no significant age-related changes in the frequency of handling of different object categories and no significant site-by-age interaction effects (all adjusted *p*s > 0.05). Thus, the the broad composition of handled objects remained largely stable over age (Figure 5).

```{r age-effects-bycategory-fig, fig.env = "figure", fig.pos = "!ht", fig.align = "center", fig.width = 3.4, fig.height = 2.9, fig.cap = "Frequency of handling by object category across age. Individual points show raw percentages per hour for each child, and lines reflect model-predicted percentages."}

ggplot(age.bycategory.effects.toplot,
       aes(x = age, y = predicted*100, color = site, fill = site)) +
  facet_wrap(. ~ category, nrow = 2) +
  geom_line(size = 1) +
  # add points for individual kids
  geom_jitter(category.props.byage, mapping = aes(
    x = age, y = prop*100, color = site, fill = site),
    alpha = 0.25, size = 0.5) +
  scale_fill_manual(values = site.colors) +
  scale_color_manual(values = site.colors) +
  scale_x_continuous(breaks = c(0, 12, 24, 36, 48)) +
  labs(x = "Age (months)", y = "% Handling", color = "Site", fill = "Site") +
  theme_test(base_size = 8) +
  theme(legend.position = "bottom")
```

```{r, age-objects}
# calculate total # unique objects per kid
daily.objects.byage <- data %>%
  group_by(site, sub_num, age) %>%
  summarize(n.objects = length(unique(object))) %>%
  ungroup()

# model total # unique objects handled by site and age
model <- lm(n.objects ~ site * age, daily.objects.byage)

daily.objects.byage.effects <- tidy(model) %>%
    filter(term != "(Intercept)" & p.value < 0.10)

# get model predicted values for plotting
daily.objects.byage.effects.toplot <- ggpredict(
  model, terms = c("site", "age [all]"),
  type = "fixed", back.transform = TRUE) %>%
  rename(age = group, site = x)

# calculate # unique objects per hour per kid
hourly.objects.byage <- data %>%
  group_by(site, sub_num, age, hour) %>%
  summarize(n.objects = length(unique(object))) %>%
  ungroup()

# model total # unique objects handled per hour by site and age
model <- lmer(n.objects ~ site * age + (1|sub_num), hourly.objects.byage)

# marginal increase in unique objects per hour with age
hourly.objects.byage.effects <- tidy(model) %>%
    filter(effect == "fixed" & term != "(Intercept)" & p.value < 0.10)

# get model predicted values for plotting
hourly.objects.byage.effects.toplot <- ggpredict(
  model, terms = c("site", "age [all]"), type = "fixed",
  back.transform = TRUE) %>%
  rename(age = group, site = x) %>%
  mutate(age = as.numeric(as.character(age)))

# compute # of transitions between objects per hour per kid
# and compare that to the total number of objects in each hour
# to get the relative number of object transitions ("rel.transitions")
hourly.object.transitions <- data %>%
  group_by(sub_num, image) %>%
  # first, calculate # categories per image
  mutate(n.objects = length(unique(object)), 
         all.objects = paste(object, collapse = ", ")) %>%
  ungroup() %>%
  select(site, sub_num, image, age, hour, n.objects, all.objects) %>%
  distinct() %>%
  # second, add cols w/ prev category and check if there's been a change
  # in held object---if so, mark it as a transition == 1
  mutate(prev.objects = lag(all.objects, 1), 
         same.child = ifelse(sub_num == lag(sub_num, 1), 1, 0), 
         transition = ifelse(all.objects != prev.objects &
                               same.child == 1, 1, 0)) %>%
  group_by(site, sub_num, age, hour) %>%
  summarize(n.transitions = sum(transition, na.rm = TRUE)) %>%
  left_join(hourly.objects.byage, by = c("site", "sub_num", "age", "hour")) %>%
  mutate(rel.transitions = n.transitions/n.objects)

# model number of hourly transitions between by site and age
model <- lmer(rel.transitions ~ site * age + (1|sub_num),
              hourly.object.transitions)

# marginal increase in object transitions per hour with age
hourly.object.transitions.byage.effects <- tidy(model) %>%
  filter(effect == "fixed" & term != "(Intercept)") %>%
  mutate(term = str_remove(term, "Tseltal"))

# get model predicted values for plotting
hourly.object.transitions.byage.effects.toplot <- ggpredict(
  model, terms = c("site", "age [all]"), type = "fixed",
  back.transform = TRUE) %>%
  rename(age = group, site = x) %>%
  mutate(age = as.numeric(as.character(age)))
```

```{r, age-categories}
# calculate total # objects per category and prop objects per category, per kid
category.props.byage <- data %>%
  group_by(sub_num, category, site, age) %>%
  summarize(n.category = n()) %>%
  ungroup() %>% 
  group_by(sub_num, site, age) %>%
  summarize(n.images = sum(n.category), 
            n.category = n.category, 
            category = category) %>%
  mutate(prop = n.category/n.images) %>%
  ungroup() %>%
  mutate(category = factor(category,
                              levels = categories))
  
# model proportion of object handling by site and age
age.effects.list <- list()
age.effects.toplot.list <- list()
for (i in categories) {
  model <- lm(prop ~ site * age,
              filter(category.props.byage, category == i))
  
  effects <- tidy(model) %>%
    mutate(category = i) %>%
    filter(term != "(Intercept)" & p.value < 0.10)
  
  # get model predicted values for plotting
  effects.toplot <- ggpredict(model, terms = c("site", "age [all]"),
                              type = "fixed", back.transform = TRUE) %>%
  rename(age = group, site = x) %>%
  mutate(category = i)
  
  age.effects.list[[i]] <- effects
  age.effects.toplot.list[[i]] <- effects.toplot
}

age.effects <- do.call(rbind, age.effects.list)
age.effects.toplot <- do.call(rbind, age.effects.toplot.list) %>%
  mutate(category = factor(category,
                              levels = categories))

# compute # unique categories per hour per kid
hourly.categories.byage <- data %>%
  group_by(site, sub_num, age, hour) %>%
  summarize(n.categories = length(unique(category))) %>%
  ungroup()

# model # categories per hour by site and age
model <- lmer(n.categories ~ site * age + (1|sub_num), hourly.categories.byage)

# increase in unique objects per hour with age
hourly.categories.byage.effects <- tidy(model) %>%
    filter(effect == "fixed" & term != "(Intercept)" & p.value < 0.10)

# get model predicted values for plotting
hourly.categories.byage.effects.toplot <- ggpredict(
  model, terms = c("site", "age [all]"), type = "fixed",
  back.transform = TRUE) %>%
  rename(age = group, site = x) %>%
  mutate(age = as.numeric(as.character(age)))

# compute # unique categories per hour per kid
hourly.total.categories <- data %>%
  group_by(sub_num, hour) %>%
  summarize(n.categories = length(unique(category)))

# compute # of transitions between categories per hour per kid
# and compare that to the total number of categories in each hour
# to get the relative number of category transitions ("rel.transitions")
hourly.category.transitions <- data %>%
  group_by(sub_num, image) %>%
  # first, calculate # categories per image
  mutate(n.categories = length(unique(category)), 
         all.categories = paste(category, collapse = ", ")) %>%
  ungroup() %>%
  select(site, sub_num, image, age, hour, n.categories, all.categories) %>%
  distinct() %>%
  # second, add cols w/ prev category and check if there's been a change
  # in held object---if so, mark it as a transition == 1
  mutate(prev.categories = lag(all.categories, 1), 
         same.child = ifelse(sub_num == lag(sub_num, 1), 1, 0), 
         transition = ifelse(all.categories != prev.categories &
                               same.child == 1, 1, 0)) %>%
  group_by(site, sub_num, age, hour) %>%
  summarize(n.transitions = sum(transition, na.rm = TRUE)) %>%
  left_join(hourly.total.categories, by = c("sub_num", "hour")) %>%
  mutate(rel.transitions = n.transitions/n.categories)

# model number of hourly transitions between by site and age
model <- lmer(rel.transitions ~ site * age + (1|sub_num),
              hourly.category.transitions)

# increase in category transitions per hour with age
hourly.category.transitions.byage.effects <- tidy(model) %>%
    filter(effect == "fixed" & term != "(Intercept)")

# get model predicted values for plotting
hourly.category.transitions.byage.effects.toplot <- ggpredict(
  model, terms = c("site", "age [all]"), type = "fixed",
  back.transform = TRUE) %>%
  rename(age = group, site = x) %>%
  mutate(age = as.numeric(as.character(age)))
```

_Does object handling diversify with age?_ In addition to the overall age-related increase in handling found by Casillas and Elliott [-@casillasURdaylong], we see that, with increasing age, children handled more unique objects per hour ($\beta$ = `r round(subset(hourly.objects.byage.effects, term == "age")$estimate, 2)`, _SE_ = `r round(subset(hourly.objects.byage.effects, term == "age")$std.error, 2)`, _t_ = `r round(subset(hourly.objects.byage.effects, term == "age")$statistic, 2)`, _p_ = `r round(subset(hourly.objects.byage.effects, term == "age")$p.value, 3)`; Figure 6A) and more objects from different categories per hour ($\beta$ = `r round(subset(hourly.categories.byage.effects, term == "age")$estimate, 2)`, _SE_ = `r round(subset(hourly.categories.byage.effects, term == "age")$std.error, 2)`, _t_ = `r round(subset(hourly.categories.byage.effects, term == "age")$statistic, 2)`, _p_ = `r round(subset(hourly.categories.byage.effects, term == "age")$p.value, 3)`). These effects were consistent across sites; we found no main effects of site or interactions between site and age (all *p*s > 0.05).

_Does object handling become more complex with age?_ Analysis of children's relative rate of transition between objects per hour (i.e., the number of transitions from one object to another divided by the number of available objects for that hour) did not reveal an overall age-related increase ($\beta$ = `r round(subset(hourly.object.transitions.byage.effects, term == "age")$estimate, 2)`, _SE_ = `r round(subset(hourly.object.transitions.byage.effects, term == "age")$std.error, 2)`, _t_ = `r round(subset(hourly.object.transitions.byage.effects, term == "age")$statistic, 2)`, _p_ = `r round(subset(hourly.object.transitions.byage.effects, term == "age")$p.value, 3)`). However, there was a significant main effect of site ($\beta$ = `r round(subset(hourly.object.transitions.byage.effects, term == "site")$estimate, 2)`, _SE_ = `r round(subset(hourly.object.transitions.byage.effects, term == "site")$std.error, 2)`, _t_ = `r round(subset(hourly.object.transitions.byage.effects, term == "site")$statistic, 2)`, _p_ = `r round(subset(hourly.object.transitions.byage.effects, term == "site")$p.value, 3)`) as well as a site-by-age interaction ($\beta$ = `r round(subset(hourly.object.transitions.byage.effects, term == "site:age")$estimate, 2)`, _SE_ = `r round(subset(hourly.object.transitions.byage.effects, term == "site:age")$std.error, 2)`, _t_ = `r round(subset(hourly.object.transitions.byage.effects, term == "site:age")$statistic, 2)`, _p_ = `r round(subset(hourly.object.transitions.byage.effects, term == "site:age")$p.value, 3)`), indicating that Tseltal children made fewer transitions between objects per hour than Rossel children but showed a steeper increase across age (Figure 6B). At the category level, we found that, children made marginally more transitions between object categories per hour with age ($\beta$ = `r round(subset(hourly.category.transitions.byage.effects, term == "age")$estimate, 2)`, _SE_ = `r round(subset(hourly.category.transitions.byage.effects, term == "age")$std.error, 2)`, _t_ = `r round(subset(hourly.category.transitions.byage.effects, term == "age")$statistic, 2)`, _p_ = `r round(subset(hourly.category.transitions.byage.effects, term == "age")$p.value, 3)`), with no detectable differences across sites.

```{r age-effects-fig, fig.env = "figure", fig.pos = "!ht", fig.align = "center", fig.width = 3.4, fig.height = 2.4, fig.cap = "(A) Unique objects handled per hour as a function of age. (B) Relative number of transitions between objects per hour as a function of age. Points reflect raw hourly counts for each child, and lines reflect model predictions with shaded standard error regions."}

# create fig showing increase in unique objects per hr with age
p1 <- ggplot() +
  # add trend line from lmer output
  geom_line(hourly.objects.byage.effects.toplot,
            mapping = aes(x = age, y = predicted, color = site), size = 1) +
  # add SE from lmer output
  geom_ribbon(hourly.objects.byage.effects.toplot,
              mapping = aes(x = age , ymin = predicted - conf.low,
                            ymax = predicted + conf.low, fill = site),
              alpha = 0.1) +
  # add points for individual kids
  geom_jitter(hourly.objects.byage,
              mapping = aes(x = age, y = n.objects,
                            color = site, fill = site), 
              alpha = 0.25, size = 0.5) +
  scale_color_manual(values = site.colors) +
  scale_fill_manual(values = site.colors) +
  scale_x_continuous(breaks = c(0, 12, 24, 36, 48)) +
  labs(x = "Age (months)", y = "Unique Objects/Hour",
       color = "Site", fill = "Site", tag = "A") +
  theme_test(base_size = 8)

# format so that only 1 legend appears at the bottom of combined fig
p1a <- p1 + theme(legend.position = "none", legend.direction = "horizontal", 
                  plot.tag = element_text(face = "bold"))

legend <- get_legend(p1 + theme(legend.position = "bottom"))

p2 <- ggplot() +
  # add trend line from lmer output
  geom_line(hourly.object.transitions.byage.effects.toplot,
            mapping = aes(x = age, y = predicted, color = site), size = 1) +
  # add SE from lmer output
  geom_ribbon(hourly.object.transitions.byage.effects.toplot,
              mapping = aes(x = age , ymin = predicted - conf.low,
                            ymax = predicted + conf.low, fill = site),
              alpha = 0.1) +
  # add points for individual kids
  geom_jitter(hourly.object.transitions,
              mapping = aes(x = age, y = rel.transitions,
                            color = site, fill = site), 
              alpha = 0.25, size = 0.5) +
  scale_color_manual(values = site.colors) +
  scale_fill_manual(values = site.colors) +
  scale_x_continuous(breaks = c(0, 12, 24, 36, 48)) +
  labs(x = "Age (months)", y = "Object Transitions/Hour",
       color = "Site", fill = "Site", tag = "B") +
  theme_test(base_size = 8) +
  theme(legend.position = "none", plot.tag = element_text(face = "bold"))

# combine plots and do some formatting
# (i.e., align axes and shrink space between panels)
fig6 <- align_plots(p1a, p2, align = "hv", axis = "l")
panels <- plot_grid(ggdraw(fig6[[1]]), ggdraw(fig6[[2]]), 
                    nrow = 1, rel_heights = c(1, 1))
plot_grid(panels, legend, nrow = 2, rel_heights = c(1, .1))
```

# Discussion
Just some miscellaneous notes for now

<!--
useful comments:
- maybe I’m missing it but might need to take a stance on how your data has implications for caregiver speech?
- how much is stability expected? lay it out better

perhaps for later?: Figure 3 stick finding across both sites is cool – consider speculating more about that from both embodied and cultural perspective – readers would be interested in your thoughts here. Stick fits immature hands well, can manipulate other stuff with it, its natural but also tool-like
-->

## Cross-cultural similarities and differences
Summary sentence of the broad overlap between communities on many of the measures reported above, likely owing to the many characteristics that are shared across these two cultural contexts (e.g., rural, swidden horticulturalist, housed in multi-generation family complexes). However, the differences that emerge between sites reveal the influence of market integration, the organization of daily life, and infant carrying practices [@brownIPchildrearing; @casillasURdaylong; @casillas2020early; @casillas2021early].

Marginally more unique synthetic objects for Tseltal children. Discussion of the effects of market integration on the availability of objects in Tenejapa vs. Rossel Island.

More handling of large or immovable objects for Rossel kids. Discussion of differences in the organization of young children's daily lives. More time spent socializing on/near household verandas

Greater age-related increases in transitions between objects for Tseltal children. Discussion of infant carrying practices. More time in sling for Tseltal babies so fewer opportunities to seek out different objects at the youngest ages.

## Other sources of consitency and variability
Possible changes with time of day and activity context as predicted in prior work [e.g., morning mealtimes, @casillas2020early; @casillas2021early]. Open question: are handled objects a good index for activity context?

Changes from day to day: We don't know how much overlap there is from day to day. While the exact objects may change, it's likely that they'd follow a similar right-skewed distribution since we see this for most kids in our sample and across mamy measures of children's input, including visual [@clerkin2017real; @long2021characterizing] and linguistic [@montag2018quantity].

Age: The broad composition of handled objects was largely stable across age [consistent with @long2021characterizing for visually present categories] but few categories here and also the possibility that individual types may change. More here about manual dexterity and possibly attention affecting object handling bout durations, which we don't quantify here, but the transitions per hour analysis is a first-pass way of (hopefully) getting at something similar

## Consequences for learning
Zipfian distributions can be helpful for learning [e.g., @carvalho2019rethinking]. Overlap between kids can get us to start thinking about which object names and object-relevant words and learned earlier. But important to note that there's less overlap between kids (within sites) than we see for US context [e.g., @herzberg2021exuberant], possibly owing to cultural differences and sampling strategies (e.g., two-hour videos vs. daylong photos). Another point is that while there may be less overlap between kids, there's likely more overlap between kids and adults (fewer child-specific items)

Notes for near the end: Future plans to link to daylong audio recordings. We can speculate about children's learning now that we have some understanding of the distribution of object handling and the identities of commonly handled objects. However, without knowing how often children are also hearing _talk_ about the objects they're handling, we can't fully address the word learning piece.

<!--
# Data availability statement
\vspace{1em}\fbox{\parbox[b][][c]{7.5cm}{\centering All anonymized data and analysis scripts are available at the following link: \href{https://github.com/kennedycasey/daylong-object-ids}{https://github.com/kennedycasey/daylong-object-ids}}\
}}

# Acknowledgements
This research is supported by a Gianinno Family Faculty Research Award to MC. We are enormously grateful to the participants and their families for sharing their daily lives with us. We also thank Will Fisher and Shawn C. Tice for essential contributions to the annotation software.
-->

# References 

```{r}
# References will be generated automatically by Pandoc and included here.
# The following code is some latex to format the bibliography. Do not remove it.
```


\setlength{\parindent}{-0.1in} 
\setlength{\leftskip}{0.125in}
\noindent
